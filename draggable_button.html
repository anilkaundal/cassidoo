<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Draggable Button</title>
    <link
      rel="icon"
      href="https://img.icons8.com/plasticine/100/000000/resize-four-directions.png"
      type="image/gif"
      sizes="16x16"
    />
    <style>
      body {
        margin: 0;
        background-color: hsl(0, 100%, 50%);
        position: relative;
      }

      #draggable {
        position: absolute;
        top: 0px;
        left: 0px;
        padding: 10px;
      }

      .hslbar {
        width: 100%;
        height: 50px;
        display: flex;
        flex-direction: row;
      }
    </style>
  </head>
  <body>
    <div class="hslbar"></div>
    <button id="draggable">Move me!</button>
    <script>
      /* Implement a draggable button that changes the page background color
      the further away it gets from its original position.*/
      const hslbars = document.getElementsByClassName("hslbar");
      const clickableButton = document.getElementById("draggable");
      let isDragging = false;
      let currPos = {};
      let origin = {};

      clickableButton.addEventListener("mousedown", (e) => {
        isDragging = true;
        origin.x = e.offsetX;
        origin.y = e.offsetY;
        currPos.x = parseInt(clickableButton.style.left);
        currPos.y = parseInt(clickableButton.style.top);
      });

      document.body.addEventListener("mousemove", (e) => {
        changeDragVal(e);
      });

      document.body.addEventListener("mouseleave", (e) => {
        changeDragVal(e);
        isDragging = false;
      });

      clickableButton.addEventListener("mouseup", (e) => {
        changeDragVal(e);
        isDragging = false;
      });

      const changeDragVal = (e) => {
        if (isDragging) {
          const leftCalc = parseInt(e.pageX) - parseInt(origin.x);
          clickableButton.style.left = leftCalc + "px";
          clickableButton.style.top =
            parseInt(e.pageY) - parseInt(origin.y) + "px";
          const totalWidth = Math.max(
            document.body.scrollWidth,
            document.documentElement.scrollWidth,
            document.body.offsetWidth,
            document.documentElement.offsetWidth,
            document.documentElement.clientWidth
          );
          document.body.style.backgroundColor = `hsl(${Math.floor(
            (leftCalc / totalWidth) * 360
          )},100%,50%)`;
        }
      };

      const HSL_PRECISION = 360;
      function generateHSLbar() {
        Array.from(hslbars).forEach((hslbar) => {
          hslbar.innerHTML = "";
          const width = hslbar.offsetWidth;
          for (let i = 0; i < HSL_PRECISION; i++) {
            const divContent = document.createElement("div");
            divContent.style.width = `${width}px`;
            divContent.style.height = `50px`;
            divContent.style.backgroundColor = `hsl(${i},100%,50%)`;
            hslbar.appendChild(divContent);
          }
        });
      }
      generateHSLbar();
    </script>
  </body>
</html>
